<!DOCTYPE html>
<html lang="en">

<head>
    <meta  http-equiv="content" charset="text/html;charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>国软图书管理系统</title>
    <link type="image/x-icon" rel="shortcut icon" href="./assets/images/favicon.ico" />
    <link rel="stylesheet" href="./assets/swiper/swiper.min.css">
    <link rel='stylesheet' href='./assets/css/style.css'>

</head>

<body>
    <h3>欢迎来到微信jsapi测试界面-V型知识库</h3>
    <div class="wxapi_form">
        <h3 id="menu-scan">微信扫一扫</h3>
        <span class="desc">调起微信扫一扫接口</span>
        <button class="btn btn_primary" id="scanQRCode0">scanQRCode(微信处理结果)</button>
        <button class="btn btn_primary" id="scanQRCode1">scanQRCode(直接返回结果)</button>

    </div>

</body>
<script src="http://code.jquery.com/jquery-1.9.1.js"></script>
<script src="./assets/js/jquery-3.2.1.min.js"></script>
<script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
<script src="https://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
<script src="./assets/swiper/swiper.min.js"></script>
<script src="./assets/js/html5media.min.js"></script>
<script src="./assets/js//justify-font-size.js"></script>
<script src="./assets/js/index.js" type="text/javascript"></script>
<script>


    $.ajax({
        type: 'post',
        url: 'http://114.55.175.41:3000/getWxConfig',
        data: {
            url: location.href.split('#')[0]
        },
        dataType: 'json',
        success: function(data) {
            wx.config({
                debug: true, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。
                appId: 'wxf1d75feab13b1472',
                timestamp: data.timestamp, // 必填，生成签名的时间戳
                nonceStr: data.nonceStr, // 必填，生成签名的随机串
                signature: data.signature, // 必填，签名，见附录1
                jsApiList: [
                    'playVoice',
                    'pauseVoice',
                    'stopVoice',
                    'uploadVoice',
                    'stopVoice',
                    'startRecord',
                    'stopRecord',
                    'onVoiceRecordEnd',
                    'onMenuShareAppMessage',
                    'translateVoice',
                    'checkJsApi',
                    'chooseImage',
                    'previewImage',
                    'uploadImage',
                    'downloadImage',
                    'getNetworkType',//网络状态接口
                    'openLocation',//使用微信内置地图查看地理位置接口
                    'getLocation', //获取地理位置接口
                    'hideOptionMenu',//界面操作接口1
                    'showOptionMenu',//界面操作接口2
                    'closeWindow' ,  ////界面操作接口3
                    'hideMenuItems',////界面操作接口4
                    'showMenuItems',////界面操作接口5
                    'hideAllNonBaseMenuItem',////界面操作接口6
                    'showAllNonBaseMenuItem',////界面操作接口7
                    'scanQRCode'
                ]
            });
            wx.ready(function() {
                // 9.1.1 扫描二维码并返回结果
                document.querySelector('#scanQRCode0').onclick = function () {
                    wx.scanQRCode();
                };
                document.querySelector('#scanQRCode1').onclick = function () {
                    wx.scanQRCode({
                        needResult: 1,
                        desc: 'scanQRCode desc',
                        success: function (res) {
                            alert(JSON.stringify(res));
                        }
                    });
                };
//                wx.scanQRCode({
//                    needResult: 1, // 默认为0，扫描结果由微信处理，1则直接返回扫描结果，
//                    scanType: ["qrCode","barCode"], // 可以指定扫二维码还是一维码，默认二者都有
//                    success: function (res) {
//                        var result = res.resultStr; // 当needResult 为 1 时，扫码返回的结果
//                    }
//                });
            });
            wx.error(function() {
                alert('出错鸟');
            });
        }
    });
</script>

</html>